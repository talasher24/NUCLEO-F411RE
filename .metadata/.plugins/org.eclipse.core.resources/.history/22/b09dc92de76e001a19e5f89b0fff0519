/*
 * Commands.h
 *
 *  Created on: Mar 26, 2020
 *      Author: ADMIN
 */

#ifndef COMMANDS_H_
#define COMMANDS_H_

void whichCommand(void);
void ping_callBack(uint8_t i);
void version_callback(uint8_t i);

#define NUM_OF_COMMANDS 2

#define PING_COMMAND_NAME "ping"

#define VERSION_COMMAND_NAME "version"


typedef struct {
	char* _name;
	uint8_t _size;
	void(*func_ptr)(uint8_t);
}command;

command commands [NUM_OF_COMMANDS] = {
		{PING_COMMAND_NAME, sizeof(PING_COMMAND_NAME)-1, ping_callBack},
		{VERSION_COMMAND_NAME, sizeof(m_p_version), version_callback}
};

void whichCommand (void)
{
	for (uint8_t i = 0; i < NUM_OF_COMMANDS; i++)
	{
		if (strncmp((char*)s_buffer._p_rx_buffer, commands[i]._name, commands[i]._size)==0)
		{
			commands[i].func_ptr(i);
		}
	}
}

void ping_callBack(uint8_t i)
{
	HAL_UART_Transmit(&huart2, (uint8_t*)commands[i]._name, commands[i]._size, 10);
}

void version_callback(uint8_t i)
{
	HAL_UART_Transmit(&huart2, m_p_version, commands[i]._size, 10);
}


#endif /* COMMANDS_H_ */
