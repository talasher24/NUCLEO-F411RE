/*
 * Commands.c
 *
 *  Created on: Apr 5, 2020
 *      Author: ADMIN
 */



#include "Commands.h"
#include "main.h"

#include <string.h>

//#include "stm32f4xx_hal.h"


 extern void uart_print(char* token);
 extern TIM_HandleTypeDef htim3;

void ping_callBack(char* token)
{
	uart_print(token);
}

void version_callback(char* token)
{
	uart_print(VERSION);
}

void pwm_start_callback(char* token)
{
	HAL_TIM_PWM_Start(&htim3, TIM_CHANNEL_1);
	uart_print(OK);
}

void pwm_stop_callback(char* token)
{
	HAL_TIM_PWM_Stop(&htim3, TIM_CHANNEL_1);
	uart_print(OK);
}

void pwm_dc_callback(char* token)
{
	token = strtok(NULL, " ");
	if(strlen(token) <= 0)
	{
		return;
	}
	int32_t dc = atoi(token);
	if (dc > 100) dc = 100;
	if (dc < 0)   dc = 0;
	htim3.Instance->CCR1 = dc;
	uart_print(OK);
}



